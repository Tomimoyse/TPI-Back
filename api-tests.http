### Variables
@baseUrl = http://localhost:8080
@keycloakUrl = http://localhost:8084
@clientSecret = 5oPCCoY26V5wfxCFBUvZxE3FIq7MjJDZ

### 1. Obtener Token
# @name login
POST {{keycloakUrl}}/realms/tpi-realm/protocol/openid-connect/token
Content-Type: application/x-www-form-urlencoded

&grant_type=password
&client_id=tpi-client
&client_secret={{clientSecret}}
&username=testuser
&password=password123

### Guardar token (ejecuta después del login)
@token = {{login.response.body.access_token}}

### 2. Probar
GET {{baseUrl}}/solicitudes/clientes
Authorization: Bearer {{token}}

### 3. Crear Cliente
# @name crearCliente
POST {{baseUrl}}/solicitudes/clientes
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "nombre": "Messi",
  "email": "messi@example.com"
}

### Guardar ID del cliente
@clienteId = {{crearCliente.response.body.id}}

### 4. Crear Contenedor
# @name crearContenedor
POST {{baseUrl}}/solicitudes/contenedores
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "tipo": "30 pies",
  "capacidad": 20.2
}

### Guardar ID del contenedor
@contenedorId = {{crearContenedor.response.body.id}}

### 5. Crear Solicitud
POST {{baseUrl}}/solicitudes/solicitudes
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "clienteId": {{clienteId}},
  "contenedorId": {{contenedorId}},
  "descripcion": "Envío de mercadería desde Buenos Aires a Córdoba",
  "fecha": "2025-11-20"
}

### 6. Listar Solicitudes
GET {{baseUrl}}/solicitudes/solicitudes
Authorization: Bearer {{token}}

### 7. Listar Contenedores
GET {{baseUrl}}/solicitudes/contenedores
Authorization: Bearer {{token}}

### 8. Crear Tramo (calcula distancia automáticamente)
POST {{baseUrl}}/operaciones/tramos
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "origen": "Buenos Aires, Argentina",
  "destino": "Córdoba, Argentina"
}

### 9. Listar Tramos
GET {{baseUrl}}/operaciones/tramos
Authorization: Bearer {{token}}

### 10. Calcular Distancia entre dos puntos
GET {{baseUrl}}/operaciones/tramos/distancia?origen=Buenos Aires, Argentina&destino=Mendoza, Argentina
Authorization: Bearer {{token}}

### 11. Crear Depósito
POST {{baseUrl}}/operaciones/depositos
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "nombre": "Depósito Central",
  "ubicacion": "Buenos Aires, Argentina",
  "capacidad": 1000
}

### 12. Listar Depósitos
GET {{baseUrl}}/operaciones/depositos
Authorization: Bearer {{token}}

### 13. Eliminar Cliente (requiere rol ADMIN)
DELETE {{baseUrl}}/solicitudes/clientes/1
Authorization: Bearer {{token}}